# simulating single scenario with event

    Code
      scenario$income$income_older
    Output
       [1]    0    0    0    0    0    0 3000 3000 3000 3000 3000 3000 3000 3000 3000
      [16] 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000
      [31] 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000
      [46] 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000
      [61] 3000

# simulating single scenario with event and id_on helper functions

    Code
      scenario$income$income_older
    Output
       [1]    0    0    0    0    0    0 3000 3000 3000 3000 3000 3000 3000 3000 3000
      [16] 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000
      [31] 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000
      [46] 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000 3000
      [61] 3000

# benchmarking of simulating single scenario

    Code
      print(scenario, n = Inf, width = Inf)
    Output
      # A tibble: 61 x 27
         scenario_id index years_left date        year survival_prob members$older$age
         <chr>       <int>      <int> <date>     <int>         <dbl>             <dbl>
       1 default         0         60 2020-07-15  2020      1                       40
       2 default         1         59 2021-07-15  2021      0.998                   41
       3 default         2         58 2022-07-15  2022      0.996                   42
       4 default         3         57 2023-07-15  2023      0.994                   43
       5 default         4         56 2024-07-15  2024      0.991                   44
       6 default         5         55 2025-07-15  2025      0.988                   45
       7 default         6         54 2026-07-15  2026      0.985                   46
       8 default         7         53 2027-07-15  2027      0.982                   47
       9 default         8         52 2028-07-15  2028      0.978                   48
      10 default         9         51 2029-07-15  2029      0.974                   49
      11 default        10         50 2030-07-15  2030      0.969                   50
      12 default        11         49 2031-07-15  2031      0.964                   51
      13 default        12         48 2032-07-15  2032      0.958                   52
      14 default        13         47 2033-07-15  2033      0.952                   53
      15 default        14         46 2034-07-15  2034      0.946                   54
      16 default        15         45 2035-07-15  2035      0.938                   55
      17 default        16         44 2036-07-15  2036      0.930                   56
      18 default        17         43 2037-07-15  2037      0.921                   57
      19 default        18         42 2038-07-15  2038      0.912                   58
      20 default        19         41 2039-07-15  2039      0.901                   59
      21 default        20         40 2040-07-15  2040      0.890                   60
      22 default        21         39 2041-07-15  2041      0.877                   61
      23 default        22         38 2042-07-15  2042      0.863                   62
      24 default        23         37 2043-07-15  2043      0.848                   63
      25 default        24         36 2044-07-15  2044      0.832                   64
      26 default        25         35 2045-07-15  2045      0.815                   65
      27 default        26         34 2046-07-15  2046      0.796                   66
      28 default        27         33 2047-07-15  2047      0.775                   67
      29 default        28         32 2048-07-15  2048      0.754                   68
      30 default        29         31 2049-07-15  2049      0.730                   69
      31 default        30         30 2050-07-15  2050      0.705                   70
      32 default        31         29 2051-07-15  2051      0.678                   71
      33 default        32         28 2052-07-15  2052      0.650                   72
      34 default        33         27 2053-07-15  2053      0.620                   73
      35 default        34         26 2054-07-15  2054      0.588                   74
      36 default        35         25 2055-07-15  2055      0.555                   75
      37 default        36         24 2056-07-15  2056      0.521                   76
      38 default        37         23 2057-07-15  2057      0.485                   77
      39 default        38         22 2058-07-15  2058      0.449                   78
      40 default        39         21 2059-07-15  2059      0.412                   79
      41 default        40         20 2060-07-15  2060      0.374                   80
      42 default        41         19 2061-07-15  2061      0.337                   81
      43 default        42         18 2062-07-15  2062      0.300                   82
      44 default        43         17 2063-07-15  2063      0.263                   83
      45 default        44         16 2064-07-15  2064      0.229                   84
      46 default        45         15 2065-07-15  2065      0.195                   85
      47 default        46         14 2066-07-15  2066      0.164                   86
      48 default        47         13 2067-07-15  2067      0.135                   87
      49 default        48         12 2068-07-15  2068      0.109                   88
      50 default        49         11 2069-07-15  2069      0.0866                  89
      51 default        50         10 2070-07-15  2070      0.0668                  90
      52 default        51          9 2071-07-15  2071      0.0501                  91
      53 default        52          8 2072-07-15  2072      0.0365                  92
      54 default        53          7 2073-07-15  2073      0.0257                  93
      55 default        54          6 2074-07-15  2074      0.0175                  94
      56 default        55          5 2075-07-15  2075      0.0114                  95
      57 default        56          4 2076-07-15  2076      0.00709                 96
      58 default        57          3 2077-07-15  2077      0.00420                 97
      59 default        58          2 2078-07-15  2078      0.00236                 98
      60 default        59          1 2079-07-15  2079      0.00124                 99
      61 default        60          0 2080-07-15  2080      0.000614               100
         income$income_older total_income spending$spending1 nondiscretionary_spending
                       <dbl>        <dbl>              <dbl>                     <dbl>
       1                   0            0              72000                     72000
       2                   0            0              72000                     72000
       3                   0            0              72000                     72000
       4                   0            0              72000                     72000
       5                   0            0              72000                     72000
       6                   0            0              72000                     72000
       7                3000         3000              72000                     72000
       8                3000         3000              72000                     72000
       9                3000         3000              72000                     72000
      10                3000         3000              72000                     72000
      11                3000         3000              72000                     72000
      12                3000         3000              72000                     72000
      13                3000         3000              72000                     72000
      14                3000         3000              72000                     72000
      15                3000         3000              72000                     72000
      16                3000         3000              72000                     72000
      17                3000         3000              72000                     72000
      18                3000         3000              72000                     72000
      19                3000         3000              72000                     72000
      20                3000         3000              72000                     72000
      21                3000         3000              72000                     72000
      22                3000         3000              72000                     72000
      23                3000         3000              72000                     72000
      24                3000         3000              72000                     72000
      25                3000         3000              72000                     72000
      26                3000         3000              72000                     72000
      27                3000         3000              72000                     72000
      28                3000         3000              72000                     72000
      29                3000         3000              72000                     72000
      30                3000         3000              72000                     72000
      31                3000         3000              72000                     72000
      32                3000         3000              72000                     72000
      33                3000         3000              72000                     72000
      34                3000         3000              72000                     72000
      35                3000         3000              72000                     72000
      36                3000         3000              72000                     72000
      37                3000         3000              72000                     72000
      38                3000         3000              72000                     72000
      39                3000         3000              72000                     72000
      40                3000         3000              72000                     72000
      41                3000         3000              72000                     72000
      42                3000         3000              72000                     72000
      43                3000         3000              72000                     72000
      44                3000         3000              72000                     72000
      45                3000         3000              72000                     72000
      46                3000         3000              72000                     72000
      47                3000         3000              72000                     72000
      48                3000         3000              72000                     72000
      49                3000         3000              72000                     72000
      50                3000         3000              72000                     72000
      51                3000         3000              72000                     72000
      52                3000         3000              72000                     72000
      53                3000         3000              72000                     72000
      54                3000         3000              72000                     72000
      55                3000         3000              72000                     72000
      56                3000         3000              72000                     72000
      57                3000         3000              72000                     72000
      58                3000         3000              72000                     72000
      59                3000         3000              72000                     72000
      60                3000         3000              72000                     72000
      61                3000         3000              72000                     72000
         human_capital liabilities portfolio$allocation $returns$GlobalStockIndexFund
                 <dbl>       <dbl> <list>                                       <dbl>
       1        65199.    1964228. <tibble [2 x 4]>                            0.0449
       2        67315.    1953631. <tibble [2 x 4]>                            0.0449
       3        69499.    1942690. <tibble [2 x 4]>                            0.0449
       4        71755.    1931394. <tibble [2 x 4]>                            0.0449
       5        74083.    1919731. <tibble [2 x 4]>                            0.0449
       6        76487.    1907690. <tibble [2 x 4]>                            0.0449
       7        78969.    1895258. <tibble [2 x 4]>                            0.0449
       8        78434.    1882423. <tibble [2 x 4]>                            0.0449
       9        77882.    1869171. <tibble [2 x 4]>                            0.0449
      10        77312.    1855489. <tibble [2 x 4]>                            0.0449
      11        76723.    1841364. <tibble [2 x 4]>                            0.0449
      12        76116.    1826780. <tibble [2 x 4]>                            0.0449
      13        75488.    1811722. <tibble [2 x 4]>                            0.0449
      14        74841.    1796176. <tibble [2 x 4]>                            0.0449
      15        74172.    1780126. <tibble [2 x 4]>                            0.0449
      16        73481.    1763554. <tibble [2 x 4]>                            0.0449
      17        72769.    1746445. <tibble [2 x 4]>                            0.0449
      18        72033.    1728781. <tibble [2 x 4]>                            0.0449
      19        71273.    1710544. <tibble [2 x 4]>                            0.0449
      20        70488.    1691714. <tibble [2 x 4]>                            0.0449
      21        69678.    1672274. <tibble [2 x 4]>                            0.0449
      22        68842.    1652203. <tibble [2 x 4]>                            0.0449
      23        67978.    1631480. <tibble [2 x 4]>                            0.0449
      24        67087.    1610086. <tibble [2 x 4]>                            0.0449
      25        66167.    1587997. <tibble [2 x 4]>                            0.0449
      26        65216.    1565191. <tibble [2 x 4]>                            0.0449
      27        64235.    1541645. <tibble [2 x 4]>                            0.0449
      28        63222.    1517335. <tibble [2 x 4]>                            0.0449
      29        62176.    1492236. <tibble [2 x 4]>                            0.0449
      30        61097.    1466322. <tibble [2 x 4]>                            0.0449
      31        59982.    1439568. <tibble [2 x 4]>                            0.0449
      32        58831.    1411946. <tibble [2 x 4]>                            0.0449
      33        57643.    1383427. <tibble [2 x 4]>                            0.0449
      34        56416.    1353983. <tibble [2 x 4]>                            0.0449
      35        55149.    1323583. <tibble [2 x 4]>                            0.0449
      36        53842.    1292197. <tibble [2 x 4]>                            0.0449
      37        52491.    1259792. <tibble [2 x 4]>                            0.0449
      38        51097.    1226336. <tibble [2 x 4]>                            0.0449
      39        49658.    1191794. <tibble [2 x 4]>                            0.0449
      40        48172.    1156132. <tibble [2 x 4]>                            0.0449
      41        46638.    1119312. <tibble [2 x 4]>                            0.0449
      42        45054.    1081297. <tibble [2 x 4]>                            0.0449
      43        43419.    1042049. <tibble [2 x 4]>                            0.0449
      44        41730.    1001527. <tibble [2 x 4]>                            0.0449
      45        39987.     959690. <tibble [2 x 4]>                            0.0449
      46        38187.     916496. <tibble [2 x 4]>                            0.0449
      47        36329.     871899. <tibble [2 x 4]>                            0.0449
      48        34411.     825856. <tibble [2 x 4]>                            0.0449
      49        32430.     778319. <tibble [2 x 4]>                            0.0449
      50        30385.     729239. <tibble [2 x 4]>                            0.0449
      51        28274.     678566. <tibble [2 x 4]>                            0.0449
      52        26094.     626249. <tibble [2 x 4]>                            0.0449
      53        23843.     572235. <tibble [2 x 4]>                            0.0449
      54        21519.     516467. <tibble [2 x 4]>                            0.0449
      55        19120.     458890. <tibble [2 x 4]>                            0.0449
      56        16644.     399445. <tibble [2 x 4]>                            0.0449
      57        14086.     338070. <tibble [2 x 4]>                            0.0449
      58        11446.     274704. <tibble [2 x 4]>                            0.0449
      59         8720.     209282. <tibble [2 x 4]>                            0.0449
      60         5906.     141737. <tibble [2 x 4]>                            0.0449
      61         3000       72000  <tibble [2 x 4]>                            0.0449
         $$InflationProtectedBonds financial_wealth net_worth discretionary_spending
                             <dbl>            <dbl>     <dbl>                  <dbl>
       1                      0.02          375000  -1524029.                -81453.
       2                      0.02          394270. -1492046.                -80844.
       3                      0.02          413642. -1459549.                -80220.
       4                      0.02          433104. -1426535.                -79579.
       5                      0.02          452643. -1393005.                -78920.
       6                      0.02          472246. -1358957.                -78242.
       7                      0.02          491893. -1324396.                -77541.
       8                      0.02          514669. -1289320.                -76817.
       9                      0.02          537554. -1253735.                -76066.
      10                      0.02          560525. -1217652.                -75287.
      11                      0.02          583557. -1181083.                -74476.
      12                      0.02          606620. -1144043.                -73631.
      13                      0.02          629683. -1106551.                -72749.
      14                      0.02          652706. -1068630.                -71827.
      15                      0.02          675648. -1030306.                -70862.
      16                      0.02          698463.  -991610.                -69849.
      17                      0.02          721098.  -952579.                -68786.
      18                      0.02          743495.  -913254.                -67669.
      19                      0.02          765590.  -873681.                -66493.
      20                      0.02          787313.  -833913.                -65254.
      21                      0.02          808588.  -794008.                -63949.
      22                      0.02          829328.  -754033.                -62572.
      23                      0.02          849444.  -714059.                -61121.
      24                      0.02          868834.  -674164.                -59590.
      25                      0.02          887393.  -634437.                -57975.
      26                      0.02          905005.  -594969.                -56274.
      27                      0.02          921547.  -555862.                -54483.
      28                      0.02          936888.  -517224.                -52600.
      29                      0.02          950891.  -479168.                -50622.
      30                      0.02          963411.  -441814.                -48549.
      31                      0.02          974297.  -405289.                -46382.
      32                      0.02          983393.  -369722.                -44123.
      33                      0.02          990540.  -335244.                -41774.
      34                      0.02          995577.  -301990.                -39343.
      35                      0.02          998343.  -270091.                -36836.
      36                      0.02          998679.  -239677.                -34264.
      37                      0.02          996430.  -210871.                -31640.
      38                      0.02          991452.  -183787.                -28981.
      39                      0.02          983609.  -158528.                -26303.
      40                      0.02          972781.  -135179.                -23631.
      41                      0.02          958866.  -113807.                -20986.
      42                      0.02          941784.   -94459.                -18395.
      43                      0.02          921477.   -77153.                -15886.
      44                      0.02          897916.   -61881.                -13488.
      45                      0.02          871097.   -48606.                -11227.
      46                      0.02          841049.   -37260.                 -9130.
      47                      0.02          807825.   -27745.                 -7219.
      48                      0.02          771508.   -19937.                 -5515.
      49                      0.02          732201.   -13687.                 -4030.
      50                      0.02          690026.    -8828.                 -2770.
      51                      0.02          645113.    -5179.                 -1734.
      52                      0.02          597600.    -2555.                  -915.
      53                      0.02          547620.     -772.                  -280.
      54                      0.02          495277.      329.                     0 
      55                      0.02          438936.     -834.                  -372.
      56                      0.02          385352.     2551.                  1245.
      57                      0.02          329256.     5271.                  2857.
      58                      0.02          263837.      578.                   358.
      59                      0.02          200409.     -154.                     0 
      60                      0.02          136627.      796.                   796.
      61                      0.02           69485.      485.                     0 
         total_spending financial_wealth_end risk_tolerance
                  <dbl>                <dbl>          <dbl>
       1         -9453.              394270.            0.5
       2         -8844.              413642.            0.5
       3         -8220.              433104.            0.5
       4         -7579.              452643.            0.5
       5         -6920.              472246.            0.5
       6         -6242.              491893.            0.5
       7         -5541.              514669.            0.5
       8         -4817.              537554.            0.5
       9         -4066.              560525.            0.5
      10         -3287.              583557.            0.5
      11         -2476.              606620.            0.5
      12         -1631.              629683.            0.5
      13          -749.              652706.            0.5
      14           173.              675648.            0.5
      15          1138.              698463.            0.5
      16          2151.              721098.            0.5
      17          3214.              743495.            0.5
      18          4331.              765590.            0.5
      19          5507.              787313.            0.5
      20          6746.              808588.            0.5
      21          8051.              829328.            0.5
      22          9428.              849444.            0.5
      23         10879.              868834.            0.5
      24         12410.              887393.            0.5
      25         14025.              905005.            0.5
      26         15726.              921547.            0.5
      27         17517.              936888.            0.5
      28         19400.              950891.            0.5
      29         21378.              963411.            0.5
      30         23451.              974297.            0.5
      31         25618.              983393.            0.5
      32         27877.              990540.            0.5
      33         30226.              995577.            0.5
      34         32657.              998343.            0.5
      35         35164.              998679.            0.5
      36         37736.              996430.            0.5
      37         40360.              991452.            0.5
      38         43019.              983609.            0.5
      39         45697.              972781.            0.5
      40         48369.              958866.            0.5
      41         51014.              941784.            0.5
      42         53605.              921477.            0.5
      43         56114.              897916.            0.5
      44         58512.              871097.            0.5
      45         60773.              841049.            0.5
      46         62870.              807825.            0.5
      47         64781.              771508.            0.5
      48         66485.              732201.            0.5
      49         67970.              690026.            0.5
      50         69230.              645113.            0.5
      51         70266.              597600.            0.5
      52         71085.              547620.            0.5
      53         71720.              495277.            0.5
      54         72000               438936.            0.5
      55         71628.              385352.            0.5
      56         73245.              329256.            0.5
      57         74857.              263837.            0.5
      58         72358.              200409.            0.5
      59         72000               136627.            0.5
      60         72796.               69485.            0.5
      61         72000                  505.            0.5
         smooth_consumption_preference consumption_impatience_preference
                                 <dbl>                             <dbl>
       1                             1                              0.04
       2                             1                              0.04
       3                             1                              0.04
       4                             1                              0.04
       5                             1                              0.04
       6                             1                              0.04
       7                             1                              0.04
       8                             1                              0.04
       9                             1                              0.04
      10                             1                              0.04
      11                             1                              0.04
      12                             1                              0.04
      13                             1                              0.04
      14                             1                              0.04
      15                             1                              0.04
      16                             1                              0.04
      17                             1                              0.04
      18                             1                              0.04
      19                             1                              0.04
      20                             1                              0.04
      21                             1                              0.04
      22                             1                              0.04
      23                             1                              0.04
      24                             1                              0.04
      25                             1                              0.04
      26                             1                              0.04
      27                             1                              0.04
      28                             1                              0.04
      29                             1                              0.04
      30                             1                              0.04
      31                             1                              0.04
      32                             1                              0.04
      33                             1                              0.04
      34                             1                              0.04
      35                             1                              0.04
      36                             1                              0.04
      37                             1                              0.04
      38                             1                              0.04
      39                             1                              0.04
      40                             1                              0.04
      41                             1                              0.04
      42                             1                              0.04
      43                             1                              0.04
      44                             1                              0.04
      45                             1                              0.04
      46                             1                              0.04
      47                             1                              0.04
      48                             1                              0.04
      49                             1                              0.04
      50                             1                              0.04
      51                             1                              0.04
      52                             1                              0.04
      53                             1                              0.04
      54                             1                              0.04
      55                             1                              0.04
      56                             1                              0.04
      57                             1                              0.04
      58                             1                              0.04
      59                             1                              0.04
      60                             1                              0.04
      61                             1                              0.04
         time_value_discount discretionary_spending_utility
                       <dbl>                          <dbl>
       1              1                                0   
       2              0.962                            0   
       3              0.925                            0   
       4              0.889                            0   
       5              0.855                            0   
       6              0.822                            0   
       7              0.790                            0   
       8              0.760                            0   
       9              0.731                            0   
      10              0.703                            0   
      11              0.676                            0   
      12              0.650                            0   
      13              0.625                            0   
      14              0.601                            0   
      15              0.577                            0   
      16              0.555                            0   
      17              0.534                            0   
      18              0.513                            0   
      19              0.494                            0   
      20              0.475                            0   
      21              0.456                            0   
      22              0.439                            0   
      23              0.422                            0   
      24              0.406                            0   
      25              0.390                            0   
      26              0.375                            0   
      27              0.361                            0   
      28              0.347                            0   
      29              0.333                            0   
      30              0.321                            0   
      31              0.308                            0   
      32              0.296                            0   
      33              0.285                            0   
      34              0.274                            0   
      35              0.264                            0   
      36              0.253                            0   
      37              0.244                            0   
      38              0.234                            0   
      39              0.225                            0   
      40              0.217                            0   
      41              0.208                            0   
      42              0.200                            0   
      43              0.193                            0   
      44              0.185                            0   
      45              0.178                            0   
      46              0.171                            0   
      47              0.165                            0   
      48              0.158                            0   
      49              0.152                            0   
      50              0.146                            0   
      51              0.141                            0   
      52              0.135                            0   
      53              0.130                            0   
      54              0.125                            0   
      55              0.120                            0   
      56              0.116                            7.13
      57              0.111                            7.96
      58              0.107                            5.88
      59              0.103                            0   
      60              0.0989                           6.68
      61              0.0951                           0   
         discretionary_spending_utility_weighted savings saving_rate
                                           <dbl>   <dbl>       <dbl>
       1                                0             0        0    
       2                                0             0        0    
       3                                0             0        0    
       4                                0             0        0    
       5                                0             0        0    
       6                                0             0        0    
       7                                0             0        0    
       8                                0             0        0    
       9                                0             0        0    
      10                                0             0        0    
      11                                0             0        0    
      12                                0             0        0    
      13                                0             0        0    
      14                                0          2827.       0.942
      15                                0          1862.       0.621
      16                                0           849.       0.283
      17                                0             0        0    
      18                                0             0        0    
      19                                0             0        0    
      20                                0             0        0    
      21                                0             0        0    
      22                                0             0        0    
      23                                0             0        0    
      24                                0             0        0    
      25                                0             0        0    
      26                                0             0        0    
      27                                0             0        0    
      28                                0             0        0    
      29                                0             0        0    
      30                                0             0        0    
      31                                0             0        0    
      32                                0             0        0    
      33                                0             0        0    
      34                                0             0        0    
      35                                0             0        0    
      36                                0             0        0    
      37                                0             0        0    
      38                                0             0        0    
      39                                0             0        0    
      40                                0             0        0    
      41                                0             0        0    
      42                                0             0        0    
      43                                0             0        0    
      44                                0             0        0    
      45                                0             0        0    
      46                                0             0        0    
      47                                0             0        0    
      48                                0             0        0    
      49                                0             0        0    
      50                                0             0        0    
      51                                0             0        0    
      52                                0             0        0    
      53                                0             0        0    
      54                                0             0        0    
      55                                0             0        0    
      56                                0.00938       0        0    
      57                                0.00627       0        0    
      58                                0.00264       0        0    
      59                                0             0        0    
      60                                0.000822      0        0    
      61                                0             0        0    

